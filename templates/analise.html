
{{ define "content" }}
<div class="card shadow mb-4">
    <div class="card-header">
        <h4 class="mb-0"><i class="bi bi-graph-up"></i> An√°lise Mensal de Problemas</h4>
    </div>
    <div class="card-body">
        <form class="mb-4" method="GET">
            <div class="row">
                <div class="col-md-4">
                    <select name="mes" class="form-select">
                        {{ range $i := .Meses }}
                        <option value="{{ $i }}" {{ if eq $i $.MesSelecionado }}selected{{ end }}>{{ index $.NomesMeses (subtract $i 1) }}</option>
                        {{ end }}
                    </select>
                </div>
                <div class="col-md-4">
                    <select name="ano" class="form-select">
                        {{ range $i := .Anos }}
                        <option value="{{ $i }}" {{ if eq $i $.AnoSelecionado }}selected{{ end }}>{{ $i }}</option>
                        {{ end }}
                    </select>
                </div>
                <div class="col-md-4">
                    <button type="submit" class="btn btn-primary">Analisar</button>
                </div>
            </div>
        </form>

        <div class="table-responsive">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>Host</th>
                        <th>Total Problemas</th>
                        <th>Limites Excedidos</th>
                        <th>Pico de Trigger</th>
                        <th>Data do Pico</th>
                        <th>Quantidade</th>
                        <th>Gravidade</th>
                    </tr>
                </thead>
                <tbody>
                    {{ range .Analises }}
                    <tr>
                        <td>{{ .HostNome }}</td>
                        <td>{{ .TotalProblemas }}</td>
                        <td>{{ .LimitesExcedidos }}</td>
                        <td>{{ .PicoTrigger.Nome }}</td>
                        <td>{{ .PicoTrigger.DataPico.Format "02/01/2006" }}</td>
                        <td>{{ .PicoTrigger.Contagem }}</td>
                        <td>
                            <span class="badge {{ if eq .PicoTrigger.Gravidade "5" }}bg-danger{{ else if eq .PicoTrigger.Gravidade "4" }}bg-warning{{ else }}bg-info{{ end }}">
                                {{ .PicoTrigger.Gravidade }}
                            </span>
                        </td>
                    </tr>
                    {{ end }}
                </tbody>
            </table>
        </div>
    </div>
</div>
{{ end }}
